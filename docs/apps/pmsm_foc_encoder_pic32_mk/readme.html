<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="shortcut icon" href="../../favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="../../assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-2724382-16"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-2724382-16'); </script> <script type="text/javascript" src="../../assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="../../assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>PMSM FOC using Quadrature Encoder | Harmony 3 Motor Control Application Examples for PIC32MK family</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="PMSM FOC using Quadrature Encoder" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Harmony 3 Motor Control Applications for PIC32MK family" /> <meta property="og:description" content="Harmony 3 Motor Control Applications for PIC32MK family" /> <link rel="canonical" href="../../apps/pmsm_foc_encoder_pic32_mk/readme.html" /> <meta property="og:url" content="../../apps/pmsm_foc_encoder_pic32_mk/readme.html" /> <meta property="og:site_name" content="Harmony 3 Motor Control Application Examples for PIC32MK family" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="PMSM FOC using Quadrature Encoder" /> <script type="application/ld+json"> {"@type":"WebPage","url":"../../apps/pmsm_foc_encoder_pic32_mk/readme.html","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"../../assets/images/vendor/microchip_mplab_harmony_logo_150_transparent.png"}},"headline":"PMSM FOC using Quadrature Encoder","description":"Harmony 3 Motor Control Applications for PIC32MK family","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="../../index.html" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../../index.html" class="nav-list-link">Microchip MPLAB® Harmony 3 Motor Control Application Examples for PIC32MK family</a><ul class="nav-list "><li class="nav-list-item "><a href="../../apps/pmsm_foc_pll_estimator_pic32_mk/readme.html" class="nav-list-link">PMSM FOC using PLL Estimator</a></li><li class="nav-list-item "><a href="../../apps/mcp_pmsm_foc_pll_estimator_pic32_mk/readme.html" class="nav-list-link">PMSM FOC using PLL Estimator</a></li><li class="nav-list-item "><a href="../../apps/mcp_pmsm_foc_encoder_pic32_mk/readme.html" class="nav-list-link">PMSM FOC using Quadrature Encoder</a></li><li class="nav-list-item active"><a href="../../apps/pmsm_foc_encoder_pic32_mk/readme.html" class="nav-list-link active">PMSM FOC using Quadrature Encoder</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../../apps/docs/hardware_setup.html" class="nav-list-link">Hardware Setup</a><ul class="nav-list "><li class="nav-list-item "><a href="../../apps/docs/mchv3_pic32mk_mcf_pim_sensored.html" class="nav-list-link">MCHV3 Development Board Setup for Encoder Mode PIC32MK MCF</a></li><li class="nav-list-item "><a href="../../apps/docs/mchv3_pic32mk_mcm_pim_sensored.html" class="nav-list-link">MCHV3 Development Board Setup for Encoder Mode PIC32MK MCM</a></li><li class="nav-list-item "><a href="../../apps/docs/mchv3_pic32mk_mcf_pim_sensorless.html" class="nav-list-link">MCHV3 Development Board Setup for Sensorless Mode PIC32MK MCF</a></li><li class="nav-list-item "><a href="../../apps/docs/mchv3_pic32mk_mcm_pim_sensorless.html" class="nav-list-link">MCHV3 Development Board Setup for Sensorless Mode PIC32MK MCM</a></li><li class="nav-list-item "><a href="../../apps/docs/mclv2_pic32mk_mcf_pim_sensored.html" class="nav-list-link">MCLV2 Development Board Setup for Sensored Mode PIC32MK MCF</a></li><li class="nav-list-item "><a href="../../apps/docs/mclv2_pic32mk_mcm_pim_sensored.html" class="nav-list-link">MCLV2 Development Board Setup for Sensored Mode PIC32MK MCM</a></li><li class="nav-list-item "><a href="../../apps/docs/mclv2_pic32mk_mcf_pim_sensorless.html" class="nav-list-link">MCLV2 Development Board Setup for Sensorless Mode PIC32MK MCF</a></li><li class="nav-list-item "><a href="../../apps/docs/mclv2_pic32mk_mcm_pim_sensorless.html" class="nav-list-link">MCLV2 Development Board Setup for Sensorless Mode PIC32MK MCM</a></li></ul></li><li class="nav-list-item"><a href="../../release_notes.html" class="nav-list-link">Release notes</a></li><li class="nav-list-item"><a href="../../mplab_harmony_license.html" class="nav-list-link">License</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Harmony 3 Motor Control Application Examples for PIC32MK family" aria-label="Search Harmony 3 Motor Control Application Examples for PIC32MK family" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://support.microchip.com" class="site-button" > Obtain Support from Microchip </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="../../index.html">Microchip MPLAB® Harmony 3 Motor Control Application Examples for PIC32MK family</a></li> <li class="breadcrumb-nav-list-item"><span>PMSM FOC using Quadrature Encoder</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <p><a href="https://www.microchip.com"><img src="https://www.microchip.com/ResourcePackages/Microchip/assets/dist/images/logo.png" alt="MCHP" /></a></p> <h1 id="pmsm-foc-using-quadrature-encoder"> <a href="#pmsm-foc-using-quadrature-encoder" aria-labelledby="pmsm-foc-using-quadrature-encoder" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> PMSM FOC using Quadrature Encoder </h1> <p>This example application shows how to control the Permanent Magnet Synchronous Motor (PMSM) with Quadrature Encoder based Field Oriented Control (FOC) on a PIC32MK Micro-controller.</p> <h2 id="description"> <a href="#description" aria-labelledby="description" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Description </h2> <p>Permanent Magnet Synchronous Motor (PMSM) is controlled using Field Oriented Control (FOC). Rotor position and speed is determined using Quadrature Encoder. Motor start/stop operation is controlled by the switch and motor speed can be changed by the on-board potentiometer. Waveforms and variables can be monitored runtime using X2CScope.</p> <p>Key features enabled in this project are:</p> <ul> <li>Dual shunt current measurement</li> <li>Speed control loop</li> <li>Field weakening</li> </ul> <h2 id="mhc-project-configurations"> <a href="#mhc-project-configurations" aria-labelledby="mhc-project-configurations" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> MHC Project Configurations </h2> <p><img src="../../apps/pmsm_foc_encoder_pic32_mk/images/project_graph.jpg" alt="MHC Project Graph" /></p> <ul> <li> <p><strong>ADCHS Peripheral</strong>:</p> <p>The ADCHS is used to measure analog quantities. Four channels are used to measure the Phase Current U, the Phase Current V, the DC Bus Voltage and the Potentiometer. Conversion is triggered at the PWM (zero match + offset of the switch delay)</p> </li> <li> <p><strong>MCPWM Peripheral</strong>:</p> <p>This peripheral is used to generated three phase synchronous PWM waveforms. Fault functionality is also enabled to switch off the output waveforms asynchronously.</p> </li> <li> <p><strong>QEI Peripheral</strong>:</p> <p>This peripheral is used to decode the rotor position and speed from quadrature encoder signals.</p> </li> <li> <p><strong>X2CScope</strong>:</p> <p>This component adds X2C scope protocol code. This uses UART to communicate to the host PC. X2CScope allows user to monitor variables runtime.</p> </li> <li> <p><strong>UART Peripheral</strong>:</p> <p>The UART is used for X2CScope communication to observe graphs and variable values in run time</p> </li> </ul> <h2 id="control-algorithm"> <a href="#control-algorithm" aria-labelledby="control-algorithm" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Control Algorithm </h2> <p>This section briefly explains the FOC control algorithm, software design and implementation. Refer to <a href="http://ww1.microchip.com/downloads/en/AppNotes/Sensorless-FOC-For-PMSM-using-PLL-Estimator-FW-AN-DS00002520C.pdf">Application note AN2520</a> for the PLL estimator based sensor-less FOC technique in detail.</p> <p>Field Oriented Control is the technique used to achieve the decoupled control of torque and flux. This is done by transforming the stator current quantities (phase currents) from stationary reference frame to torque and flux producing currents components in rotating reference frame using mathematical transformations. The Field Oriented Control is done as follows:</p> <ol> <li>Measure the motor phase currents.</li> <li>Transform them into the two phase system (a, b) using the Clarke transformation.</li> <li>Calculate the rotor position angle.</li> <li>Transform stator currents into the d,q-coordinate system using the Park transformation.</li> <li>The stator current torque (iq) and flux (id) producing components are controlled separately by the controllers.</li> <li>The output stator voltage space vector is transformed back from the d,q-coordinate system into the two phase system fixed with the stator by the Inverse Park transformation.</li> <li>Using the space vector modulation, the three-phase output voltage is generated.</li> </ol> <p><strong>Quadrature Encoder based FOC</strong> :</p> <p>Rotor position and speed are determined using quadrature encoder sensor. TC peripheral is configured in QDEC position mode. It counts the decoded quadrature pulses which is the position of the rotor. In this example, counter is a free running counter and software logic is implemented to get the exact angular position from the count. Speed is calculated by measuring the number of quadrature pulses in a fixed time interval.</p> <p>Rotor is first aligned to a known position by exiciting either d-axis or q-axis. And then motor is controlled in a closed loop there after.</p> <p>The following block diagram shows the software realization of the FOC algorithm.</p> <p><img src="../../apps/pmsm_foc_encoder_pic32_mk/images/encoder_pic32mk_block_diagram.bmp" alt="block_diagram" /></p> <h2 id="software-design"> <a href="#software-design" aria-labelledby="software-design" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Software Design </h2> <h2 id="software-design-1"> <a href="#software-design-1" aria-labelledby="software-design-1" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Software Design </h2> <ul> <li>PMSM FOC Control loop is implemented in the ADC result ready interrupt. Refer to the flow chart given below.</li> <li>ADC channel conversion is triggered by the PWM overflow/zero match event. This trigger point could vary based on the current measurement techniques and MCU PWM IP implementation.</li> <li>ADC interrupt frequency depends on the PWM frequency.</li> <li>Slow loop task is executed 10 times slower than ADC interrupt. Polling of switches for user inputs and reference speed calculation is handled in the slow loop task.</li> </ul> <h3 id="timing-diagram"> <a href="#timing-diagram" aria-labelledby="timing-diagram" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Timing Diagram </h3> <p><img src="../../apps/pmsm_foc_encoder_pic32_mk/images/timing_diagram.png" alt="timing_diagram" /></p> <h3 id="flow-chart"> <a href="#flow-chart" aria-labelledby="flow-chart" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Flow Chart </h3> <p><img src="../../apps/pmsm_foc_encoder_pic32_mk/images/flow_chart.png" alt="flow_chart" /></p> <h3 id="state-machine"> <a href="#state-machine" aria-labelledby="state-machine" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> State Machine </h3> <ul> <li><strong>Idle</strong>:</li> </ul> <p>In this state, control waits for the switch press.</p> <ul> <li><strong>Flying Start</strong>:</li> </ul> <p>In this state, the control algorithm detects if the motor is freewheeling. If the motor’s freewheeling speed is above the minimum Flying Start Detect speed and in the same direction as the command direction, the state machine directly enters in to “Closed Loop” state.</p> <p>However, if the freewheeling speed is less than minimum Flying Start Detect speed, the control algorithm attempts to passive brake the motor by applying pulses of “NUll Vectors”.</p> <p>If the freewheeling speed is more than the minimum Flying Start Detect speed but in the opposite direction of the command direction, the control algorithm attempts to active brake the motor by regenerative braking (if enabled). Once the motor speed falls below the minimum Flying Start Detect speed, the control algorithm attempts to passive brake the motor by applying pulses of “NUll Vectors”.</p> <ul> <li><strong>Field Alignment</strong>:</li> </ul> <p>Rotor is aligned to known position at D-axis or Q-axis by applying a pre-defined value of the current for a pre-defined length of time. The magnitude of the current and the length of the time for which it is applied depends upon the electrical and mechanical time constant of the PMSM motor drive. Electrical time constant of the motor is a function of R and L values of the motor windings, whereas the mechanical time constant of the motor drive is primarily a function of the static load on the motor shaft.</p> <ul> <li><strong>Open Loop</strong>:</li> </ul> <p>This state is applicable to sensorless position feedback methods. In this state, the speed of the PMSM motor is gradually ramped up using an open loop control. During this mode, the rotor angle is derived from the asserted open loop speed reference. This derived rotor angle would be lagging from the actual rotor angle. The speed is ramped up linearly to a minimum value required for the PLL estimator to estimate the electrical speed of the PMSM motor with sufficient accuracy. Rotor angle information is obtained by integrating the estimated electrical speed of the motor.</p> <ul> <li><strong>Closing Loop</strong>:</li> </ul> <p>In this state, control waits for stabilization time.</p> <ul> <li><strong>Closed Loop</strong>:</li> </ul> <p>Control switched to closed loop and rotor angle is obtained from the configured position feedback method.</p> <h3 id="code-structure"> <a href="#code-structure" aria-labelledby="code-structure" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Code Structure </h3> <p><img src="../../apps/pmsm_foc_encoder_pic32_mk/images/code_structure.png" alt="code_structure" /></p> <p>Configurations:</p> <ul> <li>mc_userparameters.h contains the user configurations.</li> <li>mc_derivedparameters.h contains the calculated values used in the code.</li> <li>mc_pmsm_foc_common.h - common data structures and defines</li> </ul> <p>PMSM_FOC:</p> <ul> <li>mc_pmsm_foc.c/h - PMSM FOC algorithm interface file</li> </ul> <p>Interrupts:</p> <ul> <li>mc_control_loop.c - Control loop is implemented in the ADC result ready ISR.</li> <li>mc_errorhandler.c - PWM fault ISR to take corrective action on over-current</li> </ul> <p>Control library:</p> <ul> <li>mc_lib.c/h - FOC library</li> <li>mc_picontroller.c/h - PI controller implementation</li> <li>mc_pwm.c/h - Space Vector modulation (SVM) and updating PWM duty cycles</li> <li>lib_mc_flyingstart.a - Flying Start Control Library</li> </ul> <p>Control Middleware:</p> <ul> <li>mc_speed.c/h - Calculate the reference speed</li> <li>mc_rotorposition.c/.h - Calculate the position and speed of the rotor</li> <li>mc_voltagemeasurement.c/h - Get the DC Bus voltage</li> <li>mc_currentmeasurement.c/h - Get the motor phase currents</li> </ul> <p>HAL:</p> <ul> <li>mc_hal.h - Hardware Abstraction Layer to interact with PLIBs</li> </ul> <h3 id="2-samc21-and-pic32cm-mc"> <a href="#2-samc21-and-pic32cm-mc" aria-labelledby="2-samc21-and-pic32cm-mc" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2. SAMC21 and PIC32CM MC </h3> <ul> <li>PMSM FOC Control loop is implemented in the ADC result ready interrupt. Refer to the flow chart given below.</li> <li>ADC channel conversion is triggered by the PWM overflow/zero match event. This trigger point could vary based on the current measurement techniques and MCU PWM IP implementation.</li> <li>For bandwidth constraints, the FOC is executed every alternate PWM cycle</li> <li>Slow loop task is executed in every 10ms in the task process. Polling of switches for user inputs is handled in the slow loop task.</li> </ul> <h3 id="timing-diagram-1"> <a href="#timing-diagram-1" aria-labelledby="timing-diagram-1" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Timing Diagram </h3> <p><img src="../../apps/pmsm_foc_encoder_pic32_mk/images/timing_diagram_fixed_point.jpg" alt="timing_diagram" /></p> <h3 id="flow-chart-1"> <a href="#flow-chart-1" aria-labelledby="flow-chart-1" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Flow Chart </h3> <p><img src="../../apps/pmsm_foc_encoder_pic32_mk/images/flow_chart_fixed_point.jpg" alt="flow_chart" /></p> <h3 id="state-machine-1"> <a href="#state-machine-1" aria-labelledby="state-machine-1" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> State Machine </h3> <ul> <li><strong>Idle</strong>:</li> </ul> <p>In this state, control waits for the switch press.</p> <ul> <li><strong>Field Alignment</strong>:</li> </ul> <p>Rotor is aligned to known position at D-axis or Q-axis by applying a pre-defined value of the current for a pre-defined length of time. The magnitude of the current and the length of the time for which it is applied depends upon the electrical and mechanical time constant of the PMSM motor drive. Electrical time constant of the motor is a function of R and L values of the motor windings, whereas the mechanical time constant of the motor drive is primarily a function of the static load on the motor shaft.</p> <ul> <li><strong>Closed Loop</strong>:</li> </ul> <p>Control switched to closed loop and rotor angle is obtained from the configured position feedback method.</p> <h3 id="code-structure-1"> <a href="#code-structure-1" aria-labelledby="code-structure-1" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Code Structure </h3> <p><img src="../../apps/pmsm_foc_encoder_pic32_mk/images/code_structure_fixed_point.jpg" alt="code_structure" /></p> <p>Configurations:</p> <ul> <li>mc_userparameters.h contains the user configurations.</li> </ul> <p>PMSM FOC Application:</p> <ul> <li>mc_pmsm_foc.c/h - PMSM FOC algorithm interface file</li> </ul> <p>Interrupts:</p> <ul> <li>mc_function_coordinator.c - Initializes and coordinates motor control ISR and slow task processes</li> <li>mc_error_handler.c - PWM fault ISR to take corrective action on over-current</li> </ul> <p>Control Middleware:</p> <ul> <li>mc_motor_control.c/h - Implements the motor control state machines.</li> </ul> <p>Control library:</p> <ul> <li>mc_start_up.c/h - Implements the initial field alignment and open loop start-up profile.</li> <li>mc_speed_control.c/h - Calculate and regulates the reference speed</li> <li>mc_current_control.c/h - Controls the direct and quadrature axis currents</li> <li>mc_rotor_position.c/.h - Calculate the position and speed of the rotor</li> <li>mc_voltage_measurement.c/h - Get the DC Bus voltage</li> <li>mc_current_measurement.c/h - Get the motor phase currents</li> <li>mc_interface_handling.c/h - Manages global variables and data-types</li> <li>mc_generic_library.c/h - FOC library</li> <li>mc_pwm.c/h - Space Vector modulation (SVM) and updating PWM duty cycles</li> <li>mc_ramp_profiler.c/h - Speed reference profiles for user inputs</li> </ul> <p>HAL:</p> <ul> <li>mc_hardware_abstraction.c/h - Hardware Abstraction Layer to interact with PLIBs</li> </ul> <h2 id="development-kits"> <a href="#development-kits" aria-labelledby="development-kits" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Development Kits </h2> <h3 id="mclv2-with-pic32mk-family-motor-control-pim"> <a href="#mclv2-with-pic32mk-family-motor-control-pim" aria-labelledby="mclv2-with-pic32mk-family-motor-control-pim" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> MCLV2 with PIC32MK Family Motor Control PIM </h3> <h4 id="downloading-and-building-the-application"> <a href="#downloading-and-building-the-application" aria-labelledby="downloading-and-building-the-application" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Downloading and building the application </h4> <p>To clone or download this application from Github, go to the <a href="https://github.com/Microchip-MPLAB-Harmony/mc_apps_pic32_mk">main page of this repository</a> and then click <strong>Clone</strong> button to clone this repository or download as zip file. This content can also be downloaded using content manager by following these <a href="https://github.com/Microchip-MPLAB-Harmony/contentmanager/wiki">instructions</a>.</p> <p>Path of the application within the repository is <strong>apps/pmsm_foc_encoder_pic32_mk</strong> .</p> <p>To build the application, refer to the following table and open the project using its IDE.</p> <div class="table-wrapper"><table> <thead> <tr> <th>Project Name</th> <th>Description</th> <th>Demo User Guide</th> </tr> </thead> <tbody> <tr> <td>mclv2_pic32mk_mcf_pim.X</td> <td>MPLABX project for MCLV2 board with PIC32MK MCF PIM</td> <td><a href="../../apps/docs/mclv2_pic32mk_mcf_pim_sensored.html">MCLV2 with PIC32MK MCF PIM</a></td> </tr> <tr> <td>mclv2_pic32mk_mcm_pim.X</td> <td>MPLABX project for MCLV2 board with PIC32MK MCM PIM</td> <td><a href="../../apps/docs/mclv2_pic32mk_mcm_pim_sensored.html">MCLV2 with PIC32MK MCM PIM</a></td> </tr> <tr> <td> </td> <td> </td> <td> </td> </tr> </tbody> </table></div> <h3 id="mchv3-with-pic32mk-family-motor-control-pim"> <a href="#mchv3-with-pic32mk-family-motor-control-pim" aria-labelledby="mchv3-with-pic32mk-family-motor-control-pim" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> MCHV3 with PIC32MK Family Motor Control PIM </h3> <h4 id="downloading-and-building-the-application-1"> <a href="#downloading-and-building-the-application-1" aria-labelledby="downloading-and-building-the-application-1" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Downloading and building the application </h4> <p>To clone or download this application from Github, go to the <a href="https://github.com/Microchip-MPLAB-Harmony/mc_apps_pic32_mk">main page of this repository</a> and then click <strong>Clone</strong> button to clone this repository or download as zip file. This content can also be downloaded using content manager by following these <a href="https://github.com/Microchip-MPLAB-Harmony/contentmanager/wiki">instructions</a>.</p> <p>Path of the application within the repository is <strong>apps/pmsm_foc_encoder_pic32_mk</strong> .</p> <p>To build the application, refer to the following table and open the project using its IDE.</p> <div class="table-wrapper"><table> <thead> <tr> <th>Project Name</th> <th>Description</th> <th>Demo User Guide</th> </tr> </thead> <tbody> <tr> <td>mchv3_pic32mk_mcf_pim.X</td> <td>MPLABX project for MCHV3 board with PIC32MK MCF PIM</td> <td><a href="../../apps/docs/mchv3_pic32mk_mcf_pim_sensored.html">MCHV3 with PIC32MK MCF PIM</a></td> </tr> <tr> <td>mchv3_pic32mk_mcm_pim.X</td> <td>MPLABX project for MCHV3 board with PIC32MK MCM PIM</td> <td><a href="../../apps/docs/mchv3_pic32mk_mcm_pim_sensored.html">MCHV3 with PIC32MK MCM PIM</a></td> </tr> <tr> <td> </td> <td> </td> <td> </td> </tr> </tbody> </table></div> <hr> <footer> <p class="text-small text-grey-dk-000 mb-0"><img src='https://raw.githubusercontent.com/wiki/Microchip-MPLAB-Harmony/Microchip-MPLAB-Harmony.github.io/images/microchip_logo.png' /><br />Copyright &copy; 2020 Microchip Technology.</p> <!-- <p class="text-small text-grey-dk-000 mb-0"><img src='../../assets/images/vendor/microchip_logo.png' /><br /> Copyright &copy; 2022 Microchip Technology.</p> --> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
